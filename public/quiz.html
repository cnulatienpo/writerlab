<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="/quiz-embed.js"></script>
  questions.forEach((q,i)=>{
    const qDiv=document.createElement('div'); qDiv.className='question';
    const qTitle=document.createElement('h3'); qTitle.textContent=q.question; qDiv.appendChild(qTitle);
    const ansDiv=document.createElement('div'); ansDiv.className='answers';
    q.answers.forEach((a,idx)=>{
      const id=`q${i}_a${idx}`;
      const label=document.createElement('label');
      const input=document.createElement('input');
      input.type='radio'; input.name=`q${i}`; input.value=idx+1; input.id=id;
      label.appendChild(input); label.append(' '+a);
      ansDiv.appendChild(label);
    });
    qDiv.appendChild(ansDiv); quizDiv.appendChild(qDiv);
  });
  document.getElementById('submitBtn').onclick=()=>{
    const selections=[...document.querySelectorAll('input[type=radio]:checked')];
    if(selections.length!==questions.length){alert('Please answer all questions.');return;}
    const counts={};
    selections.forEach(s=>{counts[s.value]=(counts[s.value]||0)+1;});
    const max=Math.max(...Object.values(counts));
    const winners=Object.keys(counts).filter(k=>counts[k]===max);
    const resultDiv=document.getElementById('result');
    resultDiv.innerHTML='';
    if(winners.length>1){
      resultDiv.classList.remove('hidden');
      const p=document.createElement('p');
      p.textContent='Tie! Choose your writer type:';
      resultDiv.appendChild(p);
      winners.forEach(num=>{
        const type=answerKey[num];
        const btn=document.createElement('button');
        btn.textContent=type; btn.onclick=()=>showResult(type);
        resultDiv.appendChild(btn);
      });
    } else {
      showResult(answerKey[winners[0]]);
    }
    function showResult(type){
      const slug=type.split(/[\s/]/)[0].toLowerCase();
      // Save writer type to localStorage for Ray Ray personalization
      localStorage.setItem('writerType', slug);
      window.location.href=`/profile/${slug}`;
    }
  };
})();
</script>
</body>
</html>
